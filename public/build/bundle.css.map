{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "..\\..\\GraphCigarretesSales.svelte",
    "..\\..\\Chartjs.svelte",
    "..\\..\\OffworksStatsTable.svelte"
  ],
  "sourcesContent": [
    "<script>\r\n    import {\r\n        pop\r\n    } from \"svelte-spa-router\";\r\n    import Button from \"sveltestrap/src/Button.svelte\";\r\nasync function loadGraph(){\r\n\r\n\r\nconst res = await fetch(\"api/v2/cigarretes-sales\");\r\nlet datos = await res.json();\r\nlet comunidad = datos.filter((datos)=> datos.year===2007).map((datos) => datos.community);\r\nlet venta_de_cigarros = datos.filter((datos) => datos.year===2007).map((datos) => datos.cigarrete_sale);\r\nlet primera_variacion = datos.filter((datos) => datos.year===2007).map((datos) => datos.first_variation);\r\nlet segunda_variacion = datos.filter((datos) => datos.year===2007).map((datos) => datos.second_variation);\r\nconsole.log(\"Graph_NONO\");\r\nHighcharts.chart('container', {\r\n    title: {\r\n        text: 'Venta de paquetes de tabaco en 2007'\r\n    },\r\n    xAxis: {\r\n        categories: comunidad\r\n    },\r\n    \r\n    series: [{\r\n        type: 'column',\r\n        name: 'Ventas de paquetes de tabaco',\r\n        data: venta_de_cigarros\r\n    }, {\r\n        type: 'column',\r\n        name: 'Primera variacion',\r\n        data: primera_variacion\r\n    }, {\r\n        type: 'column',\r\n        name: 'Segunda variacion',\r\n        data: segunda_variacion\r\n    }]\r\n});\r\n\r\n}\r\n</script>\r\n\r\n<svelte:head>\r\n    <script src=\"https://code.highcharts.com/highcharts.js\" on:load={loadGraph} defer></script>\r\n    <script src=\"https://code.highcharts.com/modules/series-label.js\" on:load={loadGraph} defer></script>\r\n    <script src=\"https://code.highcharts.com/modules/exporting.js\" on:load={loadGraph} defer></script>\r\n    <script src=\"https://code.highcharts.com/modules/export-data.js\" on:load={loadGraph} defer></script>\r\n    <script src=\"https://code.highcharts.com/modules/accessibility.js\" on:load=\"{loadGraph}\" defer></script>\r\n</svelte:head>\r\n\r\n<main>\r\n    <Button outline color=\"secondary\" on:click=\"{pop}\">Volver</Button><br>\r\n   \r\n    <figure class=\"highcharts-figure\">\r\n        <div id=\"container\"></div>\r\n        <p class=\"highcharts-description\">\r\n            El gráfico de barras muestra un estudio de millones de paquetes de tabaco comprados en el año 2007 , comparando este año con 2003 (primera variacion) \r\n            y con 2012 (segunda variacion).\r\n        </p>\r\n    </figure>\r\n</main>\r\n\r\n<style>\r\n.highcharts-figure, .highcharts-data-table table {\r\n    min-width: 310px; \r\n    max-width: 800px;\r\n    margin: 1em auto;\r\n}\r\n\r\n#container {\r\n    height: 400px;\r\n}\r\n\r\n.highcharts-data-table table {\r\n\tfont-family: Verdana, sans-serif;\r\n\tborder-collapse: collapse;\r\n\tborder: 1px solid #EBEBEB;\r\n\tmargin: 10px auto;\r\n\ttext-align: center;\r\n\twidth: 100%;\r\n\tmax-width: 500px;\r\n}\r\n.highcharts-data-table caption {\r\n    padding: 1em 0;\r\n    font-size: 1.2em;\r\n    color: #555;\r\n}\r\n.highcharts-data-table th {\r\n\tfont-weight: 600;\r\n    padding: 0.5em;\r\n}\r\n.highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {\r\n    padding: 0.5em;\r\n}\r\n.highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {\r\n    background: #f8f8f8;\r\n}\r\n.highcharts-data-table tr:hover {\r\n    background: #f1f7ff;\r\n}\r\n\r\n</style>",
    "<script>\r\n  import { onMount } from \"svelte\";\r\n  //import Chart from \"chart.js\";\r\n  import Button from  \"sveltestrap/src/Button.svelte\";\r\n  import { pop } from \"svelte-spa-router\";\r\n  onMount(async () => {});\r\n\r\n  \r\n  async function loadGraph() {\r\n    \r\n    let Datos = [];\r\n\r\n        const res = await fetch(\"api/v2/fires-stats\");\r\n        Datos = await res.json();\r\n\r\n        let comunidad = Datos.filter((Datos)=> Datos.year===2007).map((Datos) => Datos.community);\r\n        let incendio = Datos.filter((Datos) => Datos.year===2007).map((Datos) => Datos.total_fire);\r\n        let forest = Datos.filter((Datos) => Datos.year===2007).map((Datos) => Datos.forest_area);\r\n        let noForest = Datos.filter((Datos) => Datos.year===2007).map((Datos) => Datos.non_forest_area);\r\n    \r\n    \r\n    var ctx = document.getElementById(\"myChart\").getContext(\"2d\");\r\n    var chart = new Chart(ctx, {\r\n      type: \"bar\",\r\n      data: {\r\n        labels: comunidad,\r\n        datasets: [\r\n          {\r\n            label: \"Nº Incendios 2007\",\r\n            backgroundColor: \"rgb(230, 126, 34)\",\r\n            borderColor: \"rgb(23, 32, 42)\",\r\n            data: incendio\r\n          },\r\n          {\r\n            label: \"Área Forestal(htras)\",\r\n            backgroundColor: \"rgb(120, 126, 4)\",\r\n            borderColor: \"rgb(23, 32, 42)\",\r\n            data: forest\r\n          },\r\n          {\r\n            label: \"Área no Forestal(htras)\",\r\n            backgroundColor: \"rgb(20, 90, 50)\",\r\n            borderColor: \"rgb(23, 32, 42)\",\r\n            data: noForest\r\n          }\r\n        ]\r\n      },\r\n      options: {}\r\n    });\r\n  }\r\n</script>\r\n<h5 class=\"titulo\">Gráfica que muestra los incendios forestales en España en el año 2006, junto con el área forestal y no forestal de cada comunidad autónoma</h5>\r\n<svelte:head>\r\n    <script src=\"https://cdn.jsdelivr.net/npm/chart.js@2.8.0\" on:load=\"{loadGraph}\"></script>\r\n</svelte:head>\r\n\r\n<canvas id=\"myChart\"></canvas>\r\n\r\n<h8>\r\n        <Button outline color=\"secondary\" on:click=\"{pop}\">Atrás &#x21a9;</Button>\r\n</h8>\r\n\r\n<style>\r\n.titulo{\r\n  text-align: center;\r\n}\r\n</style>\r\n",
    "<script>\r\n    import Table from \"sveltestrap/src/Table.svelte\";\r\n    import Button from  \"sveltestrap/src/Button.svelte\";\r\n    import { Pagination, PaginationItem, PaginationLink } from 'sveltestrap';\r\n    import Input from \"sveltestrap/src/Input.svelte\";\r\n\timport Label from \"sveltestrap/src/Label.svelte\";\r\n\timport FormGroup from \"sveltestrap/src/FormGroup.svelte\";\r\n\r\n    import { pop } from \"svelte-spa-router\"\r\n    \r\n    import { onMount } from \"svelte\";\r\n\r\n    let offworks = [];\r\n    \r\n    let offwork = {\r\n        community: \"\",\r\n        year: \"\",\r\n        accident: \"\",\r\n        sick: \"\",\r\n        numberzone: \"\"\r\n\t};\r\n\tlet searchOff = {\r\n\t\tcommunity: \"\",\r\n        year: \"\",\r\n        accident: \"\",\r\n        sick: \"\",\r\n        numberzone: \"\"\r\n\t};\r\n\r\n\tlet limit = 10;\r\n\tlet offset = 0;\r\n\tlet msgOk = false;\r\n\tlet msgErr = false;\r\n\tlet actualPag = 1;\r\n\tlet Pagsig = true;\r\n\tlet njson=0;\r\n\t//let njsonbusqueda=0;\r\n\tlet msgOkBusq = false;\r\n\tlet msgErrBusq = false;\r\n\tlet campo=\"\";\r\n\tlet value=\"\";\r\n\tlet conjCommunity= [];\r\n\tlet conjYears = [];\r\n\tlet y = \"-\";\r\n\tlet c = \"-\";\r\n\tlet communityOn = false;\r\n\tlet yearOn = false;\r\n\t//let accidentOn = false;\r\n\t//let sickOn = false;\r\n\t//let numberZoneOn = false;\r\n    onMount(getOffworksPag);\r\n\r\n    async function loadInitialData() {\r\n        const res = await fetch(\"/api/v2/offworks-stats/loadInitialData\", {\r\n            method: \"GET\"\r\n        }).then(function (res) {\r\n\t\t\tgetOffworksPag();\r\n\t\t\tif(res.status == 200){\r\n\t\t\t\tmsgOk = \"Datos iniciales cargados correctamente \";\r\n\t\t\t\tmsgErr = false;\r\n\t\t\t}\r\n        });\r\n\t}\r\n\r\n    async function getOffworksPag(){\r\n\r\n\t\tconsole.log(\"Fetching Offworks...\"+offset+\" \"+(offset+1));\r\n\t\tconst res = await fetch(\"/api/v2/offworks-stats?offset=\" + limit * offset + \"&limit=\" + limit);\r\n\t\tconst resConj = await fetch(\"/api/v2/offworks-stats\");\r\n\t\tif (res.ok){\r\n\t\t\tconsole.log(\"Ok\");\r\n\t\t\tconst json = await res.json();\r\n\t\t\toffworks = json;\r\n\t\t\tnjson=json.length;\r\n\t\t\t//console.log(json.length);\r\n\r\n\t\t\tconst json2 = await resConj.json();\r\n\t\t\tconjCommunity = json2.map((c) => {\r\n\t\t\t\t\treturn c.community;\r\n\t\t\t});\r\n\t\t\tconjCommunity = Array.from(new Set(conjCommunity)); \r\n\t\t\tconjYears = json2.map((y) => {\r\n\t\t\t\t\treturn y.year;\r\n\t\t\t});\r\n\t\t\tconjYears = Array.from(new Set(conjYears));\r\n\r\n\t\t\tif (json.length ==0){\r\n\t\t\t\tPagsig = false;\r\n\t\t\t}else{\r\n\t\t\t\tPagsig = true;\r\n\t\t\t}\r\n\t\t\tconsole.log(\"Received \"+offworks.length+\" offworks\");\r\n\t\t}else if(res.status == 404){\r\n\t\t\tconsole.log(\"Error\");\r\n\t\t\tPagsig = false;\r\n\t\t}\r\n\t}\r\n\r\n    async function insertOffworks() {\r\n        console.log(\"Inserting offworks-stats...\" + JSON.stringify(offwork));\r\n        const res = await fetch(\"/api/v2/offworks-stats\", {\r\n            method: \"POST\",\r\n            body: JSON.stringify(offwork),\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            }\r\n        }).then(function (res) {\r\n            getOffworksPag();\r\n            if(res.status == 201){\r\n\t\t\t\tmsgOk = \"Se ha añadido correctamente\";\r\n\t\t\t\tmsgErr = false;\r\n\t\t\t}else if(res.status == 400){\r\n\t\t\t\tmsgOk = false;\r\n\t\t\t\tmsgErr = \"No puede estar ningun campo vacio\";\r\n\t\t\t}else{\r\n\t\t\t\tmsgOk = false;\r\n\t\t\t\tmsgErr = \"Ya existe\";\r\n\t\t\t}\r\n        });\r\n    }\r\n\r\n    async function deleteOffwors(community, year) {\r\n        console.log(\"Deleting Offworks...\");\r\n\t\tconst res = await fetch(\"/api/v2/offworks-stats/\"+community+\"/\"+year, {\r\n\t\t\tmethod: \"DELETE\"\r\n\t\t}).then(function (res) {\r\n            getOffworksPag();\r\n\t\t\tif(res.status == 200){\r\n\t\t\t\tmsgOk = \"Dato borrado correctamente\";\r\n\t\t\t\tmsgErr = false;\r\n\t\t\t}\r\n\t\t});\r\n    }\r\n\r\n    async function deleteAllOffworks() {\r\n\t    console.log(\"Deleting All Offworks...\");\r\n\t\tconst res = await fetch(\"/api/v2/offworks-stats\", {\r\n\t\t\tmethod: \"DELETE\"\r\n\t\t}).then(function (res) {\r\n            getOffworksPag();\r\n\t\t\tif(res.status == 200){\r\n\t\t\t\tmsgOk = \"Dato borrado correctamente\";\r\n\t\t\t\tmsgErr = false;\r\n\t\t\t\tlocation.reload();\r\n\t\t\t}else{\r\n\t\t\t\tmsgOk = false;\r\n\t\t\t\tmsgErr=\"Error\";\r\n\t\t\t\t//location.reload();\r\n\t\t\t}\r\n\t\t});\r\n    }\r\n\r\n\r\n\tasync function searchComAndYear(community, year) {\r\n\t\toffset = 0;\r\n\t\tactualPag = 1; \r\n        Pagsig = false;\r\n\t\tconsole.log(\"Searching data: \" + community + \" and \" + year);\r\n\t\tvar url = \"/api/v2/offworks-stats\";\r\n\t\tif (community != \"-\" && year != \"-\") {\r\n\t\t\turl = url + \"?community=\" + community + \"&year=\" + year; \r\n\t\t} else if (community != \"-\" && year == \"-\") {\r\n\t\t\turl = url + \"?community=\" + community;\r\n\t\t} else if (community == \"-\" && year != \"-\") {\r\n\t\t\turl = url + \"?year=\" + year;\r\n\t\t}\r\n\t\tconsole.log(\"url: \" + url);\r\n\t\tconst res = await fetch(url);\r\n\t\tif (res.ok) {\r\n\t\t\tconsole.log(\"Ok:\");\r\n\t\t\tconst json = await res.json();\r\n\t\t\toffworks = json;\r\n\t\t\tconsole.log(\"Found \" + offworks.length + \" offworks.\");\r\n\t\t\tmsgOkBusq = \"Busqueda realizada\";\r\n\t\t\tmsgErrBusq = false;\r\n\t\t} else {\r\n\t\t\tmsgOkBusq = false;\r\n\t\t\tmsgErrBusq = \"No hay resultados\";\r\n\t\t\tconsole.log(\"ERROR!\");\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tasync function sumOffset(value){\r\n\t\toffset += value;\r\n\t\tactualPag += value;\r\n\t\tgetOffworksPag();\r\n\t}\r\n\r\n</script>\r\n\r\n\r\n<main>\r\n\t\r\n\t{#await offworks}\r\n\t\tLoading offworks...\r\n\t{:then offworks}\r\n\t\r\n\t<h4>Busqueda por comunidad y/o año</h4>\r\n\t<div style=\"display: inline-block;width: 10%;\" >\r\n\t\t<FormGroup style=\"width:100%;\"> \r\n\t\t\t<Label for=\"selectComunnity\"> Comunidad </Label>\r\n\t\t\t<Input type=\"select\" name=\"selectComunnity\" id=\"selectComunnity\" bind:value=\"{c}\">\r\n\t\t\t\t{#each conjCommunity as community}\r\n\t\t\t\t<option>{community}</option>\r\n\t\t\t\t{/each}\r\n\t\t\t\t<option>-</option>\r\n\t\t\t</Input>\r\n\t\t</FormGroup>\r\n\t</div>\t\r\n\t<div style=\"margin: 2px 10px;display:inline-block;width: 10%;\">\r\n\t\t<FormGroup style=\"width:100%;\"> \r\n\t\t\t<Label for=\"selectYear\"> Año </Label>\r\n\t\t\t<Input type=\"select\"  name=\"selectYear\" id=\"selectYear\" bind:value=\"{y}\">\r\n\t\t\t\t{#each conjYears as year}\r\n\t\t\t\t<option>{year}</option>\r\n\t\t\t\t{/each}\r\n\t\t\t\t<option>-</option>\r\n\t\t\t</Input>\r\n\t\t</FormGroup>\r\n\t</div>\r\n\t<div style=\"margin: 2px 10px;display:inline-block;\">\r\n\t\t<Button color=\"info\" on:click=\"{searchComAndYear(c,y)}\"> Buscar </Button>\r\n\t</div>\r\n\t{#if msgErrBusq}\r\n        <p style=\"color: red\">ERROR: {msgErrBusq}</p>\r\n\t{/if}\r\n\t{#if msgOkBusq}\r\n        <p style=\"color: green\">EXITO: {msgOkBusq}</p>\r\n\t{/if}\r\n\t\t<Table bordered >\r\n\t\t\t<thead >\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<th>Comunidad</th>\r\n\t\t\t\t\t<th>Año</th>\r\n\t\t\t\t\t<th>Accidentes</th>\r\n\t\t\t\t\t<th>Enfermedades</th>\r\n\t\t\t\t\t<th>Numero de zonas</th>\r\n\t\t\t\t\t<th>Acciones</th>\r\n\t\t\t\t</tr>\r\n\t\t\t</thead>\r\n\t\t\t<tbody>\r\n\t\t\t\t{#each offworks as off}\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td><a style=\"text-align: center;\" href=\"#/offworks-stats/{off.community}/{off.year}\">{off.community.replace(/-/g, \" \")}</a></td>\r\n\t\t\t\t\t\t<td>{off.year}</td>\r\n\t\t\t\t\t\t<td>{off.accident}</td>\r\n\t\t\t\t\t\t<td>{off.sick}</td>\r\n\t\t\t\t\t\t<td>{off.numberzone}</td>\r\n\t\t\t\t\t\t<td> <Button outline color=\"danger\" on:click=\"{deleteOffwors(off.community, off.year)}\">\r\n\t\t\t\t\t\t\tBorrar </Button> </td> <!--Borrar un recurso-->\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t{/each}\r\n\t\t\t\t<tr style=\"background-color:rgba(217, 219, 255, 0.945);\">\r\n\t\t\t\t\t<td><Input type=\"text\" bind:value=\"{offwork.community}\"/></td>\r\n\t\t\t\t\t<td><Input type=\"number\" bind:value=\"{offwork.year}\"/></td>\r\n\t\t\t\t\t<td><Input type=\"number\" bind:value=\"{offwork.accident}\"/></td>\r\n\t\t\t\t\t<td><Input type=\"number\" bind:value=\"{offwork.sick}\"/></td>\r\n\t\t\t\t\t<td><Input type=\"number\" bind:value=\"{offwork.numberzone}\"/></td>\r\n\t\t\t\t\t<td> <Button  color=\"primary\" on:click={insertOffworks}> Añadir</Button> </td>\t\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>\r\n\t\t</Table>\r\n\t{/await}\r\n\r\n\t{#if msgErr}\r\n        <p style=\"color: red\">ERROR: {msgErr}</p>\r\n\t{/if}\r\n\t{#if msgOk}\r\n        <p style=\"color: green\">EXITO: {msgOk}</p>\r\n\t{/if}\r\n\t\r\n\t<Pagination style=\"padding-left: 40%\" ariaLabel=\"Cambio de página\">\r\n\t\t{#if actualPag != 1}\r\n\t\t<PaginationItem class=\"{actualPag === 1 ? 'disabled' : ''}\">\r\n\t\t\t<PaginationLink previous href=\"#/offworks-stats\" on:click=\"{() => sumOffset(-1)}\" />\r\n\t   </PaginationItem>\r\n\r\n\t\t<PaginationItem>\r\n\t\t\t<PaginationLink href=\"#/offworks-stats\" on:click=\"{() => sumOffset(-1)}\" >{actualPag - 1}</PaginationLink>\r\n\t\t</PaginationItem>\r\n\t\t{/if}\r\n\t\t<PaginationItem active>\r\n\t\t\t<PaginationLink href=\"#/offworks-stats\" >{actualPag}</PaginationLink>\r\n\t\t</PaginationItem>\r\n\r\n\t\t{#if Pagsig && njson>=9}\r\n\t\t<PaginationItem >\r\n\t\t\t<PaginationLink href=\"#/offworks-stats\" on:click=\"{() => sumOffset(1)}\">{actualPag + 1}</PaginationLink>\r\n\t\t</PaginationItem>\r\n\t\t\r\n\r\n\t\t<PaginationItem class=\"{Pagsig ? '' : 'disabled'}\">\r\n\t\t  <PaginationLink next href=\"#/offworks-stats\" on:click=\"{() => sumOffset(1)}\"/>\r\n\t\t</PaginationItem>\r\n\t\t{/if}\r\n\r\n\t\t\r\n\t</Pagination>\r\n\r\n<Button outline color=\"secondary\" on:click=\"{pop}\"> Volver </Button>\r\n<Button outline on:click={deleteAllOffworks} color=\"danger\"> <i class=\"fa fa-trash\" aria-hidden=\"true\"></i>Borrar todo </Button> <!--Borrar todos recursos-->\r\n<Button outline on:click={loadInitialData} color=\"primary\"> <i class=\"fas fa-download\"></i> Cargar Datos Iniciales </Button>\r\n</main>\r\n\r\n<style>\r\n\ttd {text-align: center;} \r\n\tth {text-align: center;} \r\n\t\r\n</style>\r\n"
  ],
  "names": [],
  "mappings": "AA8DA,kBAAkB,eAA+B,CAAC,AAC9C,SAAS,CAAE,KAAK,CAChB,SAAS,CAAE,KAAK,CAChB,MAAM,CAAE,GAAG,CAAC,IAAI,AACpB,CAAC,AAED,UAAU,eAAC,CAAC,AACR,MAAM,CAAE,KAAK,AACjB,CAAC;ACPD,qBAAO,CAAC,AACN,UAAU,CAAE,MAAM,AACpB,CAAC;ACiPA,EAAE,cAAC,CAAC,UAAU,CAAE,MAAM,AAAC,CAAC,AACxB,EAAE,cAAC,CAAC,UAAU,CAAE,MAAM,AAAC,CAAC"
}